/* === Reset & Base === */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; color: #1a1a1a; background: #f5f5f5; line-height: 1.5; }
a { color: #2563eb; text-decoration: none; }
a:hover { text-decoration: underline; }

/* === Navbar === */
.navbar { display: flex; align-items: center; gap: 1rem; padding: 0.5rem 1rem; background: #1e293b; color: #fff; height: 52px; }
.nav-brand { display: flex; align-items: center; color: #fff; font-weight: 700; font-size: 1.1rem; flex-shrink: 0; }
.nav-brand img { display: block; height: 28px; width: auto; }
.nav-brand:hover { text-decoration: none; color: #93c5fd; }
.nav-search { flex: 1; display: flex; max-width: 400px; margin: 0 auto; }
.nav-search input { flex: 1; padding: 0.4rem 0.75rem; border: none; border-radius: 4px 0 0 4px; font-size: 0.875rem; background: #334155; color: #fff; }
.nav-search input::placeholder { color: #94a3b8; }
.nav-search input:focus { outline: none; background: #475569; }
.nav-search button { padding: 0.4rem 1rem; background: #3b82f6; color: #fff; border: none; border-radius: 0 4px 4px 0; cursor: pointer; font-size: 0.85rem; transition: background 0.15s ease; }
.nav-search button:hover { background: #2563eb; }
.nav-logout { display: flex; align-items: center; gap: 0.5rem; margin-left: auto; flex-shrink: 0; }
.nav-user { font-size: 0.8rem; color: #94a3b8; }
.nav-logout button { padding: 0.3rem 0.75rem; background: #475569; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8rem; transition: background 0.15s ease; }
.nav-logout button:hover { background: #64748b; }

/* === Breadcrumbs === */
.breadcrumbs { padding: 0.5rem 1.5rem; background: #fff; border-bottom: 1px solid #e2e8f0; font-size: 0.85rem; color: #64748b; }
.breadcrumbs a { color: #2563eb; }

/* === Content === */
.content { max-width: 1200px; margin: 1.5rem auto; padding: 0 1.5rem; }
h1 { font-size: 1.5rem; margin-bottom: 1rem; }
h2 { font-size: 1.25rem; margin: 1.5rem 0 0.75rem; }

/* === Tables === */
table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
thead { background: #f8fafc; }
th { text-align: left; padding: 0.75rem 1rem; font-weight: 600; font-size: 0.85rem; color: #475569; border-bottom: 2px solid #e2e8f0; }
td { padding: 0.75rem 1rem; border-bottom: 1px solid #f1f5f9; font-size: 0.9rem; }
tbody tr:hover { background: #f8fafc; }

/* === Badges === */
.badge { display: inline-block; padding: 0.15rem 0.5rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; }
.badge-active { background: #dcfce7; color: #166534; }
.badge-inactive { background: #fee2e2; color: #991b1b; }
.badge-completed { background: #e0e7ff; color: #3730a3; }
.badge-flag { background: #fef3c7; color: #92400e; }

/* === Pagination === */
.pagination { display: flex; align-items: center; justify-content: center; gap: 1rem; padding: 1rem 0; }
.page-link { padding: 0.4rem 1rem; background: #fff; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 0.85rem; }
.page-link:hover { background: #f1f5f9; text-decoration: none; }
.page-info { font-size: 0.85rem; color: #64748b; }

/* === Filters === */
.filters { display: flex; align-items: end; gap: 0.75rem; padding: 1rem; background: #fff; border-radius: 8px; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.08); flex-wrap: wrap; }
.filter-field { display: flex; flex-direction: column; gap: 0.25rem; }
.filter-field label { font-size: 0.75rem; font-weight: 600; color: #475569; }
.filter-field input, .filter-field select { padding: 0.4rem 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; font-size: 0.85rem; }

/* === Buttons === */
.btn { display: inline-block; padding: 0.5rem 1rem; border: none; border-radius: 4px; cursor: pointer; font-size: 0.85rem; text-decoration: none; }
.btn-primary { background: #2563eb; color: #fff; }
.btn-primary:hover { background: #1d4ed8; text-decoration: none; }
.btn-secondary { background: #e2e8f0; color: #475569; }
.btn-secondary:hover { background: #cbd5e1; text-decoration: none; }

/* === Detail Header === */
.detail-header { background: #fff; padding: 1.25rem; border-radius: 8px; margin-bottom: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
.detail-header h1 { margin-bottom: 0.75rem; }
.meta { display: grid; grid-template-columns: auto 1fr; gap: 0.25rem 1rem; font-size: 0.9rem; }
.meta dt { font-weight: 600; color: #475569; }
.meta dd { color: #1a1a1a; }

/* === Empty State === */
.empty-state { padding: 2rem; text-align: center; color: #64748b; background: #fff; border-radius: 8px; font-size: 0.95rem; }

/* === Login === */
.login-container { max-width: 360px; margin: 4rem auto; padding: 2rem; background: #fff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
.login-container h1 { text-align: center; margin-bottom: 1.5rem; }
.form-group { margin-bottom: 1rem; }
.form-group label { display: block; margin-bottom: 0.25rem; font-weight: 600; font-size: 0.85rem; color: #475569; }
.form-group input, .form-group textarea, .form-group select { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; font-size: 0.9rem; }
.login-container .btn { width: 100%; padding: 0.65rem; font-size: 1rem; }
.error { padding: 0.75rem; margin-bottom: 1rem; background: #fee2e2; color: #991b1b; border-radius: 4px; font-size: 0.85rem; }

/* === Lot Detail === */
.lot-data { background: #fff; border-radius: 8px; padding: 1.25rem; margin-bottom: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
.lot-data table { box-shadow: none; }
.lot-data th { width: 180px; }
.changed { background: #fef3c7; }
.images { display: flex; gap: 0.75rem; flex-wrap: wrap; margin-top: 1rem; }
.images img { max-width: 200px; max-height: 200px; border-radius: 4px; border: 1px solid #e2e8f0; object-fit: cover; }

/* === Override Form === */
.override-form { background: #fff; border-radius: 8px; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
.override-form .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 0.75rem; }
.override-form .form-actions { display: flex; gap: 0.75rem; margin-top: 1.5rem; }
.override-form .checkbox-group { display: flex; align-items: center; gap: 0.5rem; }
.override-form .checkbox-group input { width: auto; }

/* === Search === */
.search-context { font-size: 0.8rem; color: #64748b; }

/* === Dropzone === */
.dropzone { display: flex; align-items: center; gap: 0.4rem; padding: 0.25rem 0.625rem; border: 1.5px dashed #475569; border-radius: 4px; color: #94a3b8; font-size: 0.8rem; cursor: pointer; transition: border-color 0.15s, color 0.15s, background 0.15s; flex-shrink: 0; }
.dropzone:hover { border-color: #93c5fd; color: #fff; }
.dropzone.dragover { border-color: #3b82f6; background: rgba(59,130,246,0.15); color: #fff; }
.dropzone.uploading { opacity: 0.6; pointer-events: none; }
.dropzone input[type="file"] { display: none; }

/* === SPA Shell Layout === */
.shell { display: grid; grid-template-columns: 250px 300px 1fr; grid-template-rows: 1fr; height: calc(100vh - 52px); }
.panel { overflow-y: auto; min-height: 0; background: #fff; position: relative; }
.panel-left1 { border-right: 1px solid #e2e8f0; }
.panel-left2 { border-right: 1px solid #e2e8f0; }
.panel-main { background: #f8fafc; }

/* === Panel Components === */
.panel-header { padding: 0.625rem 1rem; border-bottom: 1px solid #e2e8f0; background: #f8fafc; position: sticky; top: 0; z-index: 2; }
.panel-header h3 { font-size: 0.8rem; font-weight: 600; color: #475569; margin: 0; text-transform: uppercase; letter-spacing: 0.03em; }
.panel-header .panel-count { font-size: 0.75rem; font-weight: 400; color: #94a3b8; margin-left: 0.35rem; text-transform: none; letter-spacing: 0; }

/* === Panel Filter === */
.panel-filter { display: flex; align-items: center; gap: 0.5rem; margin: 0; }
.panel-filter-input { flex: 1; padding: 0.3rem 0.5rem; border: 1px solid transparent; border-radius: 4px; font-size: 0.75rem; background: transparent; color: #1e293b; min-width: 0; }
.panel-filter-input:focus { outline: none; border-color: #2563eb; background: #fff; }
.panel-filter-input::placeholder { color: #94a3b8; font-style: italic; }
.panel-filter .panel-count { flex-shrink: 0; }

.panel-list { list-style: none; margin: 0; padding: 0; }
.panel-item { display: block; padding: 0.5rem 0.75rem 0.5rem 1rem; border-bottom: 1px solid #f1f5f9; cursor: pointer; transition: background 0.15s ease, border-color 0.15s ease; border-left: 3px solid transparent; }
.panel-item:hover { background: #f1f5f9; }
.panel-item.active { background: #eff6ff; border-left-color: #2563eb; }
.panel-item-title { display: block; font-size: 0.8125rem; font-weight: 500; color: #1e293b; line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.panel-item-meta { display: flex; align-items: center; gap: 0.375rem; font-size: 0.6875rem; color: #64748b; margin-top: 0.125rem; }
.panel-item-id { font-size: 0.6875rem; color: #94a3b8; }
.panel-item .badge { font-size: 0.625rem; padding: 0.1rem 0.375rem; }

.panel-table { width: 100%; border-collapse: collapse; background: #fff; }
.panel-table thead { background: #f8fafc; position: sticky; top: 0; z-index: 1; }
.panel-table th { text-align: left; padding: 0.5rem 1rem; font-weight: 600; font-size: 0.75rem; color: #475569; border-bottom: 2px solid #e2e8f0; text-transform: uppercase; letter-spacing: 0.03em; }
.panel-table td { padding: 0.4375rem 1rem; border-bottom: 1px solid #f1f5f9; font-size: 0.8125rem; }
.panel-table tbody tr:hover { background: #f8fafc; }
.panel-table td a { color: #2563eb; }
.panel-table td a:hover { text-decoration: underline; }

.panel-pagination { display: flex; align-items: center; justify-content: center; gap: 0.75rem; padding: 0.5rem 1rem; border-top: 1px solid #e2e8f0; background: #f8fafc; font-size: 0.75rem; position: sticky; bottom: 0; }
.panel-pagination a { padding: 0.2rem 0.625rem; background: #fff; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 0.75rem; color: #2563eb; cursor: pointer; text-decoration: none; transition: background 0.15s ease; }
.panel-pagination a:hover { background: #f1f5f9; text-decoration: none; }
.panel-pagination .page-info { color: #64748b; }

/* === Lots Table (Main Panel) === */
.lots-table { width: 100%; border-collapse: collapse; background: #fff; font-size: 0.8125rem; }
.lots-table thead { background: #f8fafc; position: sticky; top: 0; z-index: 1; }
.lots-table th { text-align: left; padding: 0.4rem 0.5rem; font-weight: 600; font-size: 0.6875rem; color: #475569; border-bottom: 2px solid #e2e8f0; text-transform: uppercase; letter-spacing: 0.03em; white-space: nowrap; }
.lots-table td { padding: 0.3rem 0.5rem; border-bottom: 1px solid #f1f5f9; vertical-align: middle; }
.lots-table tbody tr:hover { background: #f8fafc; }
.lot-thumb { width: 40px; height: 40px; object-fit: cover; border-radius: 3px; display: block; }
.lot-thumb-placeholder { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: #f1f5f9; border-radius: 3px; }
.lot-thumb-placeholder svg { width: 20px; height: 20px; opacity: 0.25; }
.lot-thumb-cell { width: 52px; }
.lot-desc-cell { display: flex; flex-direction: column; gap: 0.125rem; }
.lot-desc-title { font-weight: 500; color: #1e293b; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.lot-desc-notes { font-size: 0.75rem; color: #64748b; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; }
.btn-icon { display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; border-radius: 4px; color: #64748b; transition: background 0.15s ease, color 0.15s ease; }
.btn-icon:hover { background: #f1f5f9; color: #2563eb; text-decoration: none; }
.overridden { background: #fff3cd; }
.lots-table input[type="text"],
.lots-table input[type="number"] { padding: 0.2rem 0.35rem; border: 1px solid #e2e8f0; border-radius: 3px; font-size: 0.75rem; background: #fff; color: #1e293b; }
.lots-table input[type="text"]:focus,
.lots-table input[type="number"]:focus { outline: none; border-color: #2563eb; }
.lot-input-num { width: 52px; text-align: right; }
.lot-input-wide { width: 100%; }
.lot-input-sm { font-size: 0.6875rem; color: #64748b; }
.lots-table input[type="checkbox"] { width: 16px; height: 16px; cursor: pointer; }
.lots-table .htmx-indicator { display: none; }
.lots-table tr.htmx-request { opacity: 0.5; pointer-events: none; }

/* === Lot Cards (Main Panel) === */
.lot-cards { list-style: none; margin: 0; padding: 0; }
.lot-card { border-bottom: 1px solid #f1f5f9; }
.lot-card-link { display: flex; gap: 0.75rem; padding: 0.5rem 1rem; color: inherit; text-decoration: none; transition: background 0.15s ease; }
.lot-card-link:hover { background: #f1f5f9; text-decoration: none; }
.lot-card-thumb { flex-shrink: 0; width: 56px; height: 56px; border-radius: 4px; overflow: hidden; background: #f1f5f9; display: flex; align-items: center; justify-content: center; }
.lot-card-thumb img { width: 100%; height: 100%; object-fit: cover; }
.lot-card-no-img { width: 28px; height: 28px; opacity: 0.25; }
.lot-card-no-img svg { width: 100%; height: 100%; }
.lot-card-info { flex: 1; min-width: 0; display: flex; flex-direction: column; justify-content: center; }
.lot-card-title { font-size: 0.8125rem; font-weight: 600; color: #1e293b; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.lot-card-notes { font-size: 0.75rem; color: #64748b; line-height: 1.4; margin-top: 0.125rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.lot-card-more { color: #2563eb; font-size: 0.6875rem; }

/* === Panel Empty States === */
.panel-empty { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 3rem 1.5rem; text-align: center; color: #94a3b8; min-height: 200px; }
.panel-empty-icon { width: 40px; height: 40px; margin-bottom: 0.75rem; opacity: 0.35; }
.panel-empty-icon svg { width: 100%; height: 100%; }
.panel-empty p { font-size: 0.8125rem; line-height: 1.4; margin: 0; }
.panel-empty .panel-empty-hint { font-size: 0.6875rem; margin-top: 0.25rem; color: #cbd5e1; }

/* === Panel Loading Indicators === */
.htmx-indicator { display: none; position: absolute; inset: 0; background: rgba(255,255,255,0.7); z-index: 10; }
.htmx-request .htmx-indicator { display: flex; align-items: center; justify-content: center; }
.htmx-request .panel-content { opacity: 0.5; pointer-events: none; transition: opacity 0.15s ease; }
.spinner { width: 22px; height: 22px; border: 2.5px solid #e2e8f0; border-top-color: #2563eb; border-radius: 50%; animation: spin 0.6s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* === Panel Error State === */
.panel-error { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 2rem 1.5rem; text-align: center; color: #dc2626; min-height: 200px; }
.panel-error p { font-size: 0.8125rem; margin-bottom: 0.75rem; }
.panel-error button { padding: 0.35rem 0.875rem; background: #fff; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 0.75rem; color: #2563eb; cursor: pointer; transition: background 0.15s ease; }
.panel-error button:hover { background: #f1f5f9; }

/* === Nav Link === */
.nav-link { color: #94a3b8; font-size: 0.8rem; transition: color 0.15s ease; flex-shrink: 0; }
.nav-link:hover { color: #fff; text-decoration: none; }

/* === Toast === */
.toast-container { position: fixed; top: 1rem; right: 1rem; z-index: 9999; display: flex; flex-direction: column; gap: 0.5rem; pointer-events: none; }
.toast { padding: 0.75rem 1.25rem; border-radius: 6px; font-size: 0.85rem; color: #fff; pointer-events: auto; animation: toast-in 0.3s ease-out; max-width: 400px; word-break: break-word; }
.toast-error { background: #dc2626; }
.toast-success { background: #16a34a; }
.toast.fade-out { animation: toast-out 0.3s ease-in forwards; }
@keyframes toast-in { from { opacity: 0; transform: translateX(1rem); } to { opacity: 1; transform: translateX(0); } }
@keyframes toast-out { from { opacity: 1; } to { opacity: 0; } }

/* === Screen Reader Only === */
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

/* === Mobile Back Button === */
.mobile-back-btn { display: none; align-items: center; gap: 0.35rem; padding: 0.4rem 0.75rem; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 0.8rem; color: #475569; cursor: pointer; position: fixed; top: 60px; left: 0.5rem; z-index: 20; }
.mobile-back-btn:hover { background: #e2e8f0; }

/* === Modal === */
dialog#lot-modal { max-width: 700px; width: 90vw; max-height: 85vh; border-radius: 8px; border: none; padding: 0; box-shadow: 0 8px 30px rgba(0,0,0,0.15); }
dialog#lot-modal::backdrop { background: rgba(0,0,0,0.5); }
.modal-container { display: flex; flex-direction: column; max-height: 85vh; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.25rem; border-bottom: 1px solid #e2e8f0; flex-shrink: 0; }
.modal-header h2 { font-size: 1.1rem; margin: 0; }
.modal-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #64748b; padding: 0.25rem; line-height: 1; }
.modal-close:hover { color: #1e293b; }
.modal-body { padding: 1.25rem; overflow-y: auto; flex: 1; }
.modal-loading { display: flex; align-items: center; justify-content: center; padding: 3rem; }
.modal-body .lot-data { box-shadow: none; margin-bottom: 1rem; padding: 0; }
.modal-body .lot-data:last-child { margin-bottom: 0; }
.modal-body .detail-header { box-shadow: none; padding: 0; margin-bottom: 1rem; }
.modal-body .override-form { box-shadow: none; padding: 0; }

/* === Mobile/Narrow Viewport === */
@media (max-width: 767px) {
    .shell { grid-template-columns: 1fr; }
    .panel { display: none; border-right: none; }
    .shell[data-mobile-panel="sellers"] [data-panel="sellers"] { display: block; }
    .shell[data-mobile-panel="events"] [data-panel="events"] { display: block; }
    .shell[data-mobile-panel="lots"] [data-panel="lots"] { display: block; }
    .mobile-back-btn[hidden] { display: none !important; }
    .mobile-back-btn:not([hidden]) { display: flex; }
}
